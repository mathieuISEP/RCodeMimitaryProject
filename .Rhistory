a = table(1,2,4,6,8,10)
a
a
cl
#----------------------Correction TD5
Auto=read.table("Auto.txt",header = T,sep=";")
attach(Auto)
mpg01 = rep(0, length(mpg))
mpg01[mpg > median(mpg)] = 1
Auto = data.frame(Auto, mpg01)
summary(Auto)
cor(Auto[,-9])
pairs(Auto)
train = (year%%2 == 0)  # if the year is even
test = !train
Auto.train = Auto[train, ]
Auto.test = Auto[test, ]
mpg01.test = mpg01[test]
#LDA
library(MASS)
lda.fit = lda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto, subset = train)
lda.pred = predict(lda.fit, Auto.test)
mean(lda.pred$class != mpg01.test)
table(lda.pred$class,mpg01.test)
#QDA
qda.fit = qda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto, subset = train)
qda.pred = predict(qda.fit, Auto.test)
mean(qda.pred$class != mpg01.test)
table(qda.pred$class,mpg01.test)
#----ROC LDA
install.packages("pROC")
library(pROC)
lda.probs=lda.pred$posterior[,1]
ROC.lda=roc(mpg01.test,lda.probs,levels=c(1,0))
plot.roc(ROC.lda,print.auc = T,xlab="1-Specificity",col="red",axes=T)
#----ROC QDA
qda.probs=qda.pred$posterior[,1]
ROC.qda=roc(mpg01.test,qda.probs,levels=c(1,0))
plot.roc(ROC.qda,print.auc = T,xlab="1-Specificity",col="red",axes=T)
#----------------------Correction TD5
Auto=read.table("Auto.txt",header = T,sep=";")
attach(Auto)
mpg01 = rep(0, length(mpg))
mpg01[mpg > median(mpg)] = 1
Auto = data.frame(Auto, mpg01)
summary(Auto)
cor(Auto[,-9])
pairs(Auto)
train = (year%%2 == 0)  # if the year is even
test = !train
Auto.train = Auto[train, ]
Auto.test = Auto[test, ]
mpg01.test = mpg01[test]
#LDA
library(MASS)
lda.fit = lda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto, subset = train)
lda.pred = predict(lda.fit, Auto.test)
mean(lda.pred$class != mpg01.test)
table(lda.pred$class,mpg01.test)
#QDA
qda.fit = qda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto, subset = train)
qda.pred = predict(qda.fit, Auto.test)
mean(qda.pred$class != mpg01.test)
table(qda.pred$class,mpg01.test)
#----ROC LDA
install.packages("pROC")
library(pROC)
lda.probs=lda.pred$posterior[,1]
ROC.lda=roc(mpg01.test,lda.probs,levels=c(1,0))
plot.roc(ROC.lda,print.auc = T,xlab="1-Specificity",col="red",axes=T)
#----ROC QDA
qda.probs=qda.pred$posterior[,1]
ROC.qda=roc(mpg01.test,qda.probs,levels=c(1,0))
plot.roc(ROC.qda,print.auc = T,xlab="1-Specificity",col="red",axes=T)
install.packages("pROC")
setwd("~/ISEP/A3-BI/Projet_fin_de_parcours/RVisualization")
output = read.csv("output.txt", header = TRUE, sep=",")
View(output)
View(output)
