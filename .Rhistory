#changement de type des variables (string à numérique)
output1$Timestamp=as.numeric(output1$Timestamp)
output1$sourceMmsi=as.numeric(output1$sourceMmsi)
output1$Latitude = as.numeric(output1$Latitude)
output1$Longitude = as.numeric(output1$Longitude)
output2$Latitude = as.numeric(output2$Latitude)
output2$Longitude = as.numeric(output2$Longitude)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
return(data.frame(latlong))
}
earthDist <- function (lat1,long1,lat2,long2)
{
rad <- pi/180
a1 <- lat1 * rad
a2 <- long1 * rad
b1 <- lat2 * rad
b2 <- long2 * rad
dlon <- b2 - a2
dlat <- b1 - a1
a <- (sin(dlat/2))^2 + cos(a1) * cos(b1) * (sin(dlon/2))^2
c <- 2 * atan2(sqrt(a), sqrt(1 - a))
R <- 6378.145
d <- R * c
return(d)
}
BoatsTrajectories <- function (dataset){
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
UniqueBoatPosition =  dt[!duplicated(dt$sourceMmsi),,drop=F]
UniqueBoatID = UniqueBoatPosition[,c("sourceMmsi"),drop = F]
UniqueBoatIdColumned <- as.data.frame(t(UniqueBoatID))
for (i in 1:(length(UniqueBoatIdColumned))){
UniqueBoatIdColumned = append(UniqueBoatIdColumned,shipTrajectory(UniqueBoatID$sourceMmsi[i],dt))
i <- i + 1
}
return(as.data.frame(UniqueBoatIdColumned))
}
shipTrajectory(227006760,output1)
BoatsTrajectories(output1)
UniqueBoatPosition(output1)
UniqueBoatPosition =  output1[!duplicated(output1$sourceMmsi),]
UniqueBoatID <- UniqueBoatPosition[,c(22),drop = F]
UniqueBoatIdColumned <- as.data.frame(t(UniqueBoatID))
View(UniqueBoatIdColumned)
View(UniqueBoatID)
View(UniqueBoatIdColumned)
colnames(UniqueBoatIdColumned)<-(UniqueBoatIdColumned[1,])
View(UniqueBoatIdColumned)
latlong=c(output1$sourceMmsi,latlong,earthDist(lat1,long1,lat2,long2))
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(output1$sourceMmsi,latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
return(latlong)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
return(data.frame(outuput1$sourceMmsi,latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
return(data.frame(output1$sourceMmsi,latlong))
}
shipTrajectory(227006760,output1)
View(UniqueBoatIdColumned)
boatposition(227006760)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
colnames(latlong)<-(x)
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
return(data.frame(latlong))
colnames(latlong)<-(x)
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
colnames(latlong)<-(x, drop=F)
return(data.frame(latlong))
}
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
colnames(latlong)<-(x, drop=F)
return(data.frame(latlong))
}
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
x=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
#colnames(latlong)<-(x)
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
data.frame(latlong)
}
colnames(latlong)<-(x)
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
data.frame(latlong)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
data.frame(latlong)
colnames(latlong)<-(x)
}
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
print(data.frame(latlong))
colnames(latlong)<-(x)
}
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
print(data.frame(latlong))
}
colnames(latlong)<-(x)
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
print(data.frame(latlong))
}
colnames(latlong)<-"x"
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
print(data.frame(latlong))
}
#colnames(latlong)<-"x"
colnames(latlong)[colnames(latlong) == 'latlong'] <- x
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
#colnames(latlong)<-"x"
return(latlong)
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
colnames(latlong)<-"x"
return(latlong)
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong<-data.frame()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=data.frame(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
colnames(latlong)<-x
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
print(latlong)
colnames(latlong)<-x
return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
latlong<-data.frame(latlong)
print(latlong)
#colnames(latlong)<-x
#return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
latlong<-data.frame(latlong)
colnames(latlong)<-x
print(latlong)
#return(data.frame(latlong))
}
shipTrajectory(227006760,output1)
shipTrajectory <- function (shipId,dataset){
x <- shipId
#dataset <- read.csv(dataFile,sep=",", header=TRUE)
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
boatPosition = dt[which(dt$sourceMmsi == x),]
latlong=c()
for (i in 1:(nrow(boatPosition)-1)){
lat1 = boatPosition$Latitude[i]
long1 = boatPosition$Longitude[i]
lat2 = boatPosition$Latitude[i+1]
long2 = boatPosition$Longitude[i+1]
latlong=c(latlong,earthDist(lat1,long1,lat2,long2))
i <- i + 1
}
latlong<-data.frame(latlong)
colnames(latlong)<-x
print(latlong)
return(data.frame(latlong))
}
BoatsTrajectories <- function (dataset){
dt = dataset
dt$Latitude = as.double(dt$Latitude)
dt$Longitude = as.double(dt$Longitude)
UniqueBoatPosition =  dt[!duplicated(dt$sourceMmsi),,drop=F]
UniqueBoatID = UniqueBoatPosition[,c("sourceMmsi"),drop = F]
UniqueBoatIdColumned <- as.data.frame(t(UniqueBoatID))
colnames(UniqueBoatIdColumned)<-(UniqueBoatIdColumned[1,])
for (i in 1:(length(UniqueBoatIdColumned))){
UniqueBoatIdColumned = append(UniqueBoatIdColumned,shipTrajectory(UniqueBoatID$sourceMmsi[i],dt))
i <- i + 1
}
return(as.data.frame(UniqueBoatIdColumned))
}
BoatsTrajectories(output1)
